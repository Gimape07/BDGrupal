Ejercicio 7: SQL con Funciones Agregadas


Plantea las siguientes consultas en SQL, agregando los alias de columna necesarios para que resulten legibles.
subject Usando el esquema:


* Película (título, año, duración, encolor, presupuesto, nomestudio, idproductor)
* Elenco (título, año, nombre, sueldo)
* Actor (nombre, dirección, telefono, fechanacimiento, sexo)
* Productor (idproductor, nombre, dirección, teléfono)
* Estudio (nomestudio, dirección)




1. El ingreso total recibido por cada actor, sin importar en cuantas películas haya participado. 


select                 Nombre, SUM(sueldo) as ‘Ingreso Total’
from                 Elenco E
group by         Nombre
order by          ‘Ingreso TotaI’ DESC




2. El monto total destinado a películas por cada Estudio Cinematográfico, durante la década de los 80's.


select                 NomEstudio, SUM(Presupuesto) as ‘Monto Total’
from                 Pelicula P
where                año between ‘1980’ AND ‘1989’                
group by         NomEstudio
order by          ‘Monto Total’ DESC




3. Nombre y sueldo promedio de los actores (sólo hombres) que reciben en promedio un pago superior a 5 millones de dólares por película.


select                 Nombre, Avg(Sueldo) as ‘Sueldo Promedio’
from                Actor A, Elenco E
where                A.Nombre = E.Nombre
AND                 A.Sexo=’Masculino’
group by        Nombre
having                ‘Sueldo Promedio’ > 5000000
order by          ‘Sueldo Promedio’ DESC
4. Título y año de producción de las películas con menor presupuesto. (Por ejemplo, la película de Titanic se ha producido en varias veces entre la lista de películas estaría la producción de Titanic y el año que fue filmada con menor presupuesto.)


select                 Titulo, MIN(Presupuesto) as ‘Presupuesto’
from                Peliculas P                
group by        Titulo
order by        Titulo ASC




5. Mostrar el sueldo de la actriz mejor pagada.


select                 TOP(1)  E.Nombre, Sueldo
from                 Elenco E, Actor A
where                A.Nombre = E.Nombre
AND                 Sexo=’Femenino’
order by         Sueldo DESC